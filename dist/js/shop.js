"use strict";$(function(){(new function(){this.init=function(){this.checkCookie()?(this.loadMsg(),this.btnAdd=!0):alert("请先登录")},this.checkCookie=function(){var t=getCookie(document.cookie,"username");return!!t&&($(".nav-register").css("display","none"),$(".nav-login").text("欢迎您，"+t).css("width","160"),!0)},this.addEvent=function(t){this.btnAddNum=$(".btn.btn-success"),this.btnReduceNum=$(".btn.btn-warning"),this.btnMoveFromCar=$(".btn.btn-danger"),this.textMsg=$(".proName");var e=this;this.textMsg.click(function(){location.href="./message.html"}),this.product=$("table tr");for(var n=1;n<this.product.length;n++)this.product.eq(n).attr("uid",t[n-1].product_id);this.btnAddNum.click(function(){$(this).prev().text(parseInt($(this).prev().text())+1);var t=$(this).parent().parent().attr("uid");e.ajax(t,"add","http://localhost/shop7.4/shop1/dist/interface/updatewq.php")}),this.btnReduceNum.click(function(){if($(this).next().text(parseInt($(this).next().text())-1),0==$(this).next().text())if(e.checkNum($(this)))$(this).next().text(parseInt($(this).next().text())+1);else{var t=$(this).parent().parent().attr("uid"),n="http://localhost/shop7.4/shop1/dist/interface/delwq.php";e.ajax(t,"",n)}else t=$(this).parent().parent().attr("uid"),n="http://localhost/shop7.4/shop1/dist/interface/updatewq.php",e.ajax(t,"cut",n)}),this.btnMoveFromCar.click(function(){if(confirm("确定要将商品移除吗？")){$(this).parent().parent().css("display","none"),$(this).parent().prev().children().eq(1).text(0);var t=$(this).parent().parent().attr("uid");e.ajax(t,"","http://localhost/shop7.4/shop1/dist/interface/delwq.php")}}),this.checkNum=function(t){if(!confirm("要将商品移除吗？"))return!0;t.parent().next().children().eq(0).trigger("click")},this.ajax=function(t,n,e){var s="?id="+t+"&type="+n;$.ajax({url:e+s,dataType:"jsonp",success:function(t){}})}};var s=this;this.loadMsg=function(){$.ajax({url:"http://localhost/shop7.4/shop1/dist/interface/showlist.php",dataType:"jsonp",success:function(t){t=t.data;var n='<tr style="display: table-row;">\n                    <th>商品图片</th>\n                    <th>商品名</th>\n                    <th>商品价格</th>\n                    <th>商品规格</th>\n                    <th>商品数量</th>\n                    <th>移出购物车</th>\n                </tr>';for(var e in t)n+='<tr>\n                        <th>\n                            <img src="'.concat(t[e].product_img,'" alt="">\n                        </th>\n                        <td class="proName">').concat(t[e].product_name,"</td>\n                        <td>¥").concat(t[e].product_price,"</td>\n                        <td>").concat(t[e].product_guige,'</td>\n                        <td>\n                            <button class="btn btn-warning">-</button>\n                            <em>').concat(t[e].product_num,'</em>\n                            <button class="btn btn-success">+</button>\n                        </td>\n                        <td>\n                            <button class="btn btn-danger">移出购物车</button>\n                        </td>\n                    </tr>');$("table").html(n),s.addEvent(t)}})}}).init()});